
##########
#
# add the following to httpd.conf:
#
# Include conf/webauth-tests.conf
#
#########

#### Uncomment these if you haven't already enabled mod_webauth
#
# LoadModule webauth_module modules/mod_webauth.so
# WebAuthLoginURL "https://xxxxxx.stanford.edu/login/"
# WebAuthWebKdcURL "https://xxxxxx.stanford.edu/webkdc-service/"
# WebAuthWebKdcPrincipal service/webkdc
# WebAuthKeyring conf/webauth/keyring
# WebAuthKeytab conf/webauth/keytab
# WebAuthServiceTokenCache conf/webauth/service_token.cache
# WebAuthDebug on
####

##### Allow access to tests

<Location /tests/>
    Order allow,deny
    Allow from all
    WebAuthExtraRedirect off
</Location>

#
# require WebAuth authentication for everything under /tests/auth/
#
<Location /tests/auth/>
    Options ExecCGI
    AuthType WebAuth
    require valid-user
    SetHandler cgi-script
</Location>

# test basic case of WebAuth-protected page

<Location /tests/auth/test1>
    # normal webauth case
</Location>

# turn on extra redirect

<Location /tests/auth/test2>
    WebAuthReturnURL /tests/auth/test2return
</Location>

<Location /tests/auth/test2return>
    WebAuthExtraRedirect on
</Location>

# test WebAuthVarVarPrefix

<Location /tests/auth/test3>
    WebAuthVarPrefix TEST_
</Location>

# test WebAuthLoginCAnceledURL

<Location /tests/auth/test4>
    WebAuthLoginCanceledURL /tests/unauth/test4
</Location>

#  test WebAuthReturnURL

<Location /tests/auth/test5>
    WebAuthReturnURL /tests/auth/test5return
</Location>

# test query params after initial redirect

<Location /tests/auth/test6>
    WebAuthReturnURL /tests/auth/test6return?x=1&y=2
</Location>

<Location /tests/auth/test6return>
   # nothing
</Location>

# test app-token lifetime of 10s

<Location /tests/auth/test7>
    WebAuthReturnURL /tests/auth/test7return
</Location>

<Location /tests/auth/test7return>
   WebAuthAppTokenLifetime 5s
</Location>

# test app-token lifetime of 10s and force login

<Location /tests/auth/test8>
    WebAuthForceLogin on
    WebAuthReturnURL /tests/auth/test8return
</Location>

<Location /tests/auth/test8return>
   WebAuthAppTokenLifetime 5s
</Location>

# test inactive-expire and web-auth-last-use-update-interval

<Location /tests/auth/test9>
    WebAuthInactiveExpire 60m
    WebAuthLastUseUpdateInterval 5s
</Location>


# test inactive-expire and web-auth-last-use-update-interval

<Location /tests/auth/test10>
    WebAuthForceLogin on
    WebAuthInactiveExpire 20s
    WebAuthLastUseUpdateInterval 5s
</Location>

# test for no query params after initial redirect

<Location /tests/auth/test11>
    WebAuthReturnURL /tests/auth/test11return
</Location>

<Location /tests/auth/test11return>
   # nothing
</Location>

# POST test with expired cookie

<Location /tests/auth/test12>
    WebAuthReturnURL /tests/auth/test12return
</Location>

<Location /tests/auth/test12return>
    WebAuthAppTokenLifetime 1s
    WebAuthPostReturnURL /tests/auth/test12post
</Location>

##################

<Location /tests/auth/logout>
    AllowOverride All
    WebAuthDoLogout on
</Location>

<Location /tests/unauth/>
    Options ExecCGI
    SetHandler cgi-script
</Location>

##################
# PHP4
##################

#### Uncomment these if you haven't already enabled php4
# LoadModule php4_module modules/libphp4.so
# AddType application/x-httpd-php .php
####

#
# require WebAuth authentication for everything under /tests/php/
#
<Location /tests/php/>
    AuthType WebAuth
    WebAuthVarPrefix HTTP_
    require valid-user
</Location>
