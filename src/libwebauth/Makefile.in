# Makefile for libwebauth
# $Id$

srcdir		= @srcdir@
prefix          = @prefix@
exec_prefix     = @exec_prefix@
top_srcdir	= @top_srcdir@
top_builddir	= @top_builddir@
VPATH		= @srcdir@

libdir		= @libdir@

CC		= @CC@
INSTALL		= @INSTALL@
LIBTOOL		= $(top_builddir)libtool
RANLIB		= @RANLIB@

CFLAGS		= @CFLAGS@
CPPFLAGS	= -I$(srcdir) -I$(top_builddir) @CPPFLAGS@ \
		  @CRYPTO_CPPFLAGS@ @KRB5_CPPFLAGS@
LDFLAGS		= @LDFLAGS@
LDLIBS		= @CRYPTO_LIBS@ @KRB5_LIBS@ @LIBS@

LIBNAME		= libwebauth

OBJS		= attrs.o base64.o key.o krb5.o misc.o random.o \
                  token.o @WEBAUTH_AES_OBJS@
LOBJS		= $(OBJS:.o=.lo)

.SUFFIXES: .lo

all: $(LIBNAME).la

install: $(LIBNAME).la
	$(LIBTOOL) --mode=install \
	    $(INSTALL) $(LIBNAME).la $(libdir)/$(LIBNAME).la

.c.lo:
	$(LIBTOOL) --mode=compile $(CC) $(CPPFLAGS) $(CFLAGS) -c $<

$(LIBNAME).la: $(LOBJS)
	$(LIBTOOL) --mode=link $(CC) -o $@ $(LOBJS) $(LDFLAGS) $(LDLIBS) \
	    -rpath $(libdir) -version-info 0:0:0

clean:
	rm -rf *.o $(LIBNAME).la *.lo .libs *~ core \#*

depend:
	$(top_srcdir)/tools/makedepend '$(CPPFLAGS)' *.c

# DO NOT DELETE THIS LINE -- make depend depends on it.
aes_cbc.o: aes_cbc.c aes_locl.h
aes_cfb.o: aes_cfb.c aes_locl.h
aes_core.o: aes_core.c aes_locl.h
aes_ctr.o: aes_ctr.c aes_locl.h
aes_ecb.o: aes_ecb.c aes_locl.h
aes_misc.o: aes_misc.c aes_locl.h
aes_ofb.o: aes_ofb.c aes_locl.h
attrs.o: attrs.c webauthp.h $(top_builddir)/config.h webauth.h
base64.o: base64.c webauthp.h $(top_builddir)/config.h webauth.h
key.o: key.c webauthp.h $(top_builddir)/config.h webauth.h
krb5.o: krb5.c webauthp.h $(top_builddir)/config.h webauth.h
misc.o: misc.c webauthp.h $(top_builddir)/config.h webauth.h
random.o: random.c webauthp.h $(top_builddir)/config.h webauth.h
token.o: token.c webauthp.h $(top_builddir)/config.h webauth.h
